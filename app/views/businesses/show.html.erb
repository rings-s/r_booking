<% content_for :title, @business.name %>

<!-- Back Button -->
<div class="mb-6">
  <%= link_to businesses_path, class: "inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 transition" do %>
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
    </svg>
    Back to Businesses
  <% end %>
</div>

<!-- Main Content -->
<div class="max-w-6xl mx-auto">
  <!-- Business Header with Hero and Logo -->
  <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden mb-8">
    <!-- Hero Section -->
    <% if @business.images.attached? && @business.images.first %>
      <div class="h-64 relative overflow-hidden bg-gray-100">
        <%= image_tag @business.images.first.variant(resize_to_fill: [1400, 400]), class: "w-full h-full object-cover" %>
        <div class="absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-black/50"></div>
      </div>
    <% else %>
      <div class="h-64 bg-gradient-to-br from-blue-500 via-indigo-500 to-purple-600 relative">
        <div class="absolute inset-0 bg-black opacity-10"></div>
        <!-- Decorative Pattern -->
        <div class="absolute inset-0 opacity-10">
          <div class="absolute top-10 left-10 w-32 h-32 border-4 border-white rounded-full"></div>
          <div class="absolute bottom-20 right-20 w-24 h-24 border-4 border-white rounded-full"></div>
          <div class="absolute top-1/2 left-1/3 w-16 h-16 border-4 border-white rounded-full"></div>
        </div>
      </div>
    <% end %>

    <!-- Logo and Title Section (Overlapping Hero) -->
    <div class="relative px-8 -mt-16">
      <div class="flex flex-col md:flex-row md:items-end gap-6">
        <!-- Business Logo Circle -->
        <div class="relative">
          <% if @business.logo.attached? %>
            <div class="w-32 h-32 rounded-full border-4 border-white shadow-xl overflow-hidden bg-white">
              <%= image_tag @business.logo.variant(resize_to_fill: [200, 200]), class: "w-full h-full object-cover" %>
            </div>
          <% else %>
            <div class="w-32 h-32 rounded-full border-4 border-white shadow-xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center">
              <span class="text-4xl font-bold text-white"><%= @business.name.first.upcase %></span>
            </div>
          <% end %>
          <!-- Verified Badge (optional decoration) -->
          <div class="absolute bottom-0 right-0 w-10 h-10 bg-blue-600 rounded-full border-4 border-white flex items-center justify-center shadow-lg">
            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
            </svg>
          </div>
        </div>

        <!-- Business Name and Info -->
        <div class="flex-1 pb-4">
          <h1 class="text-4xl font-bold text-gray-900 mb-2"><%= @business.name %></h1>
          <div class="flex flex-wrap items-center gap-4 text-sm text-gray-600">
            <% if @business.location.present? %>
              <div class="flex items-center gap-1.5">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
                <span><%= @business.location %></span>
              </div>
            <% end %>
            <% if @business.phone_number.present? %>
              <div class="flex items-center gap-1.5">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                </svg>
                <a href="tel:<%= @business.phone_number %>" class="hover:text-blue-600 transition"><%= @business.phone_number %></a>
              </div>
            <% end %>
            <% if @business.open_time.present? && @business.close_time.present? %>
              <div class="flex items-center gap-1.5">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span><%= @business.open_time.strftime("%I:%M %p") %> - <%= @business.close_time.strftime("%I:%M %p") %></span>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- Business Details -->
    <div class="px-8 py-6 border-t border-gray-100 mt-4">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- About Section -->
        <div class="lg:col-span-2">
          <h2 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
            <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            About This Business
          </h2>
          <% if @business.description.present? %>
            <p class="text-gray-700 leading-relaxed"><%= @business.description %></p>
          <% else %>
            <p class="text-gray-400 italic">No description available</p>
          <% end %>

          <!-- Map Section -->
          <% if @business.latitude.present? && @business.longitude.present? %>
            <div class="mt-8">
              <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
                  <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                  </svg>
                  Location
                </h2>
                <a href="https://www.google.com/maps?q=<%= @business.latitude %>,<%= @business.longitude %>"
                   target="_blank"
                   class="inline-flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-all duration-200 transform hover:-translate-y-0.5 shadow-sm">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                  </svg>
                  Share Location
                </a>
              </div>

              <div id="business-map" class="h-80 w-full rounded-lg border border-gray-300 shadow-sm"></div>

              <script>
                (function() {
                  if (typeof L === 'undefined' || !document.getElementById('business-map')) return;

                  document.addEventListener('DOMContentLoaded', function() {
                    setTimeout(function() {
                      var lat = <%= @business.latitude %>;
                      var lng = <%= @business.longitude %>;
                      var businessName = "<%= j @business.name %>";

                      var businessMap = L.map('business-map').setView([lat, lng], 15);
                      L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        maxZoom: 19,
                        attribution: '© OpenStreetMap'
                      }).addTo(businessMap);

                      var marker = L.marker([lat, lng]).addTo(businessMap);
                      marker.bindPopup('<strong>' + businessName + '</strong><br>' +
                                      'Lat: ' + lat.toFixed(6) + '<br>' +
                                      'Lng: ' + lng.toFixed(6)).openPopup();
                    }, 100);
                  });
                })();
              </script>
            </div>
          <% end %>
        </div>

        <!-- Business Owner Card -->
        <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 border border-gray-200">
          <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wide mb-4">Business Owner</h3>
          <div class="flex items-center gap-3 mb-4">
            <% if @business.user.avatar_url.present? %>
              <%= image_tag @business.user.avatar_url, class: "h-14 w-14 rounded-full object-cover border-2 border-white shadow-md" %>
            <% else %>
              <div class="h-14 w-14 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-semibold text-xl border-2 border-white shadow-md">
                <%= @business.user.name&.first&.upcase || @business.user.email.first.upcase %>
              </div>
            <% end %>
            <div>
              <p class="font-semibold text-gray-900">
                <% if @business.user.name.present? %>
                  <%= @business.user.name %>
                <% else %>
                  <%= @business.user.email.split('@').first %>
                <% end %>
              </p>
              <p class="text-sm text-gray-600"><%= @business.user.email %></p>
            </div>
          </div>

          <!-- Operating Hours Compact -->
          <% if @business.open_time.present? && @business.close_time.present? %>
            <div class="pt-4 border-t border-gray-300">
              <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">Hours</p>
              <div class="flex items-center justify-between text-sm">
                <span class="text-gray-700 flex items-center gap-1">
                  <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  Open
                </span>
                <span class="font-semibold text-gray-900"><%= @business.open_time.strftime("%I:%M %p") %></span>
              </div>
              <div class="flex items-center justify-between text-sm mt-2">
                <span class="text-gray-700 flex items-center gap-1">
                  <svg class="w-4 h-4 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  Close
                </span>
                <span class="font-semibold text-gray-900"><%= @business.close_time.strftime("%I:%M %p") %></span>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Services Section -->
  <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-8 mb-8">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-2xl font-bold text-gray-900 flex items-center gap-2">
        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
        </svg>
        Services
      </h2>
      <!-- Owner: Add Service Button -->
      <% if user_signed_in? && current_user == @business.user %>
        <%= link_to new_business_service_path(@business), class: "inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium shadow-sm hover:shadow-md transition-all duration-200 transform hover:-translate-y-0.5" do %>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
          </svg>
          Add New Service
        <% end %>
      <% end %>
    </div>

    <% if @business.services.any? %>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <% @business.services.each do |service| %>
          <div class="group bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 border border-gray-200 hover:shadow-lg transition-all duration-300">
            <!-- Service Header -->
            <div class="flex items-start justify-between mb-4">
              <div class="flex-1">
                <h3 class="text-lg font-bold text-gray-900 mb-1"><%= service.name %></h3>
                <span class="inline-block px-3 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-full">
                  <%= service.category.name %>
                </span>
              </div>
            </div>

            <!-- Service Image -->
            <% if service.images.attached? && service.images.first %>
              <div class="mb-4 rounded-lg overflow-hidden h-40 bg-gray-200">
                <%= image_tag service.images.first.variant(resize_to_fill: [400, 200]), class: "w-full h-full object-cover" %>
              </div>
            <% end %>

            <!-- Service Description -->
            <% if service.description.present? %>
              <p class="text-gray-600 text-sm mb-4 line-clamp-2"><%= service.description %></p>
            <% end %>

            <!-- Service Details -->
            <div class="space-y-2 mb-4">
              <div class="flex items-center gap-2 text-sm text-gray-700">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span><%= service.formatted_duration %></span>
              </div>
              <div class="flex items-center gap-2 text-sm text-gray-700">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span class="font-semibold text-gray-900"><%= service.formatted_price %></span>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex gap-2 pt-4 border-t border-gray-300">
              <%= link_to business_service_path(@business, service), class: "flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 rounded-lg text-sm font-medium transition" do %>
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                </svg>
                View Details
              <% end %>

              <!-- Client: Book Service Button -->
              <% if user_signed_in? && current_user.client? %>
                <%= link_to new_business_service_booking_path(@business, service), class: "flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition" do %>
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                  </svg>
                  Book Now
                <% end %>
              <% elsif !user_signed_in? %>
                <%= link_to new_user_session_path, class: "flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition" do %>
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                  </svg>
                  Sign in to Book
                <% end %>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <!-- Empty State -->
      <div class="text-center py-12">
        <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
        </svg>
        <h3 class="text-lg font-medium text-gray-900 mb-2">No services yet</h3>
        <p class="text-gray-600 mb-6">
          <% if user_signed_in? && current_user == @business.user %>
            Start adding services to let clients book appointments with your business.
          <% else %>
            This business hasn't added any services yet.
          <% end %>
        </p>
        <% if user_signed_in? && current_user == @business.user %>
          <%= link_to new_business_service_path(@business), class: "inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium shadow-sm hover:shadow-md transition" do %>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
            </svg>
            Add Your First Service
          <% end %>
        <% end %>
      </div>
    <% end %>
  </div>

  <!-- Image Gallery - Always Show If Images Exist -->
  <% if @business.images.attached? %>
    <%
      # Prepare image URLs for lightbox
      image_urls = @business.images.map { |img| url_for(img.variant(resize_to_limit: [1200, 900])) }
    %>
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-8 mb-8"
         data-controller="lightbox"
         data-lightbox-images-value="<%= image_urls.to_json %>">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold text-gray-900 flex items-center gap-2">
          <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
          </svg>
          Photo Gallery
        </h2>
        <span class="text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-full font-medium">
          <%= @business.images.count %> <%= @business.images.count == 1 ? 'Photo' : 'Photos' %>
        </span>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
        <% @business.images.each_with_index do |image, index| %>
          <button type="button"
                  class="group relative overflow-hidden rounded-xl border border-gray-200 aspect-[4/3] bg-gray-100 shadow-sm hover:shadow-xl transition-all duration-300 cursor-pointer"
                  data-action="click->lightbox#open"
                  data-index="<%= index %>">
            <%= image_tag image.variant(resize_to_fill: [500, 375]), class: "w-full h-full object-cover group-hover:scale-110 transition-transform duration-500" %>
            <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            <!-- Image expand icon on hover -->
            <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
              <div class="bg-white/90 backdrop-blur-sm rounded-full p-3 shadow-lg">
                <svg class="w-6 h-6 text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"/>
                </svg>
              </div>
            </div>
          </button>
        <% end %>
      </div>

      <!-- Lightbox Modal -->
      <div data-lightbox-target="modal"
           class="hidden fixed inset-0 z-50 bg-black/95 flex items-center justify-center"
           data-action="click->lightbox#closeOnBackdrop">
        <!-- Close Button -->
        <button type="button"
                class="absolute top-4 right-4 text-white hover:text-gray-300 transition z-50"
                data-action="click->lightbox#close">
          <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>

        <!-- Previous Button -->
        <button type="button"
                class="absolute left-4 top-1/2 -translate-y-1/2 text-white hover:text-gray-300 transition bg-black/50 hover:bg-black/70 rounded-full p-3 z-50"
                data-action="click->lightbox#previous">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>

        <!-- Image Container -->
        <div class="max-w-7xl max-h-screen p-8 flex flex-col items-center justify-center">
          <img data-lightbox-target="image"
               src=""
               alt="Gallery image"
               class="max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl">
          <div class="mt-4 text-white text-center">
            <span data-lightbox-target="counter" class="text-lg font-medium"></span>
          </div>
        </div>

        <!-- Next Button -->
        <button type="button"
                class="absolute right-4 top-1/2 -translate-y-1/2 text-white hover:text-gray-300 transition bg-black/50 hover:bg-black/70 rounded-full p-3 z-50"
                data-action="click->lightbox#next">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
          </svg>
        </button>

        <!-- Keyboard hints -->
        <div class="absolute bottom-4 left-1/2 -translate-x-1/2 text-white/70 text-sm flex gap-6">
          <span class="flex items-center gap-2">
            <kbd class="px-2 py-1 bg-white/10 rounded">←</kbd>
            <span>Previous</span>
          </span>
          <span class="flex items-center gap-2">
            <kbd class="px-2 py-1 bg-white/10 rounded">→</kbd>
            <span>Next</span>
          </span>
          <span class="flex items-center gap-2">
            <kbd class="px-2 py-1 bg-white/10 rounded">Esc</kbd>
            <span>Close</span>
          </span>
        </div>
      </div>
    </div>
  <% end %>

  <!-- Management Actions -->
  <% if user_signed_in? && (current_user == @business.user || current_user.admin?) %>
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
        <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
        </svg>
        Manage Business
      </h3>
      <div class="flex flex-wrap gap-3">
        <%= link_to calendar_business_path(@business), class: "inline-flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-all duration-200 transform hover:-translate-y-0.5 shadow-sm hover:shadow-md" do %>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
          </svg>
          View Calendar
        <% end %>
        <%= link_to edit_business_path(@business), class: "inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all duration-200 transform hover:-translate-y-0.5 shadow-sm hover:shadow-md" do %>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
          </svg>
          Edit Business
        <% end %>
        <%= button_to @business, method: :delete, data: { turbo_confirm: "Are you sure you want to delete this business? This action cannot be undone." }, class: "inline-flex items-center gap-2 px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-all duration-200 transform hover:-translate-y-0.5 shadow-sm hover:shadow-md cursor-pointer" do %>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
          </svg>
          Delete Business
        <% end %>
      </div>
    </div>
  <% end %>
</div>
